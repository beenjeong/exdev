<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		testChart1 : function() {
		    Highcharts.chart('container1', {
		        title: {
		            text: "계획/실적"
		        },
		        exporting: {
		            buttons : {
		                contextButton : {
		                    enabled : false
		                }
		            }
		        },
		        xAxis: {
		            categories: ['4', '8', '12', '16', '20', '24', '28', '32', '36', '40', '44', '48', '52', '56', '80', '88', '96']
		        },
		        yAxis: {
		            min: -12,
		            max: 12,
		            title: {
		                text: 'Gap'
		            }
		        },
		        series: [{
		            type: 'line',
		            name: 'KP200',
		            color:'#FF0000',
		            data:  [1,2,3,4,5,6,7,8] // Max 100
		        }, {
		            type: 'line',
		            name: 'KD150',
		            color:'#00FF00',
		            data:  [-1,-2,-1,-2,-1,-2,-1,-2,-1,-2,-1,-2]  // Max 100
		        }, {
		            type: 'line',
		            name: 'T-GAP',
		            color:'#0000FF',
		            data:  [-1,2,-1,2,-1,-2,1,-2,-1,-2,-1,-2]  // Max 100
		        }]
		    });
		 }
		,testChart2 : function() {
			
		    Highcharts.chart('container2', {
		        chart: {
		            plotBackgroundColor: null,
		            plotBorderWidth: 0,
		            plotShadow: false
		        },
		        title: {
		            text: 'SSAIM'
		        },
		        exporting: {
		            buttons : {
		                contextButton : {
		                    enabled : false
		                }
		            }
		        },
		        tooltip: {
		            pointFormat: '{point.name}: {point.y}<b>({point.percentage:.1f}%)</b>'
		        },
		        plotOptions: {
		            pie: {
		                dataLabels: {
		                    enabled: true,
		                    distance: -30,
		                    style: {
		                        fontWeight: 'bold',
		                        color: 'white'
		                    }
		                },
		                startAngle: 0,
		                endAngle: 360,
		                center: ['50%', '50%'],
		                size: '100%'
		            }
		        },
		        series: [{
		            type: 'pie',
		            name: 'Share',
		            innerSize: '0%',
		            data: [
		                ['S', 158],
		                ['S', 213],
		                ['A', 130],
		                ['I', 213],
		                ['M', 119]
		            ],
		            dataLabels: {
		                formatter: function () {
		                    return this.y > 1 ? '<b>' + this.point.name + ':</b> ' + this.y + ' 건' : null;
		                }
		            }
		        }]
		    });
		 }
		,testChart3 : function() {
			var parm = {
				queryGroup : [
					 {
						 queryId 		: "Chart.getProjectChartTgtData"
						,requestParm	: {pjt_id : "1752fb2c2bf463a92000", kpi_type : "E"}
					 }
					,{
						 queryId 		: "Chart.getProjectChartRecdData"
						,requestParm	: {pjt_id : "1752fb2c2bf463a92000"}
					 }
				]
			}
			C_COM.requestQuery(parm, function(resultData) {
				var cTgtList 		= resultData.data["Chart.getProjectChartTgtData"];
				// Chart List에서 TOTAL정보만 가져옴
				var totalTgtList 	= fn_searchJsonObjectArray(cTgtList, "PART_CD", "TOTAL", "E");
				// WK 오름차순으로 정렬
				totalTgtList.orderBy("YEAR_WEEK", "ASC");
				
				var cRecdList 		= resultData.data["Chart.getProjectChartRecdData"];
				// Chart List에서 TOTAL정보만 가져옴
				var totalRecdList 	= fn_searchJsonObjectArray(cRecdList, "PART_CD", "TOTAL", "E");
				// 주차별 정보 Map 형태로 변환
				totalTgtMap		= arrayToMap(totalRecdList, "WK");
				
				var parm = {
					 targetDomId	: "execChart"
					,title 			: "실행기준"
					,categories		: []
					,unitStr		: "(억원/10K)"
					,targetList 	: []
					,realList 		: []
				}
				var lastRecd = 0;
				$.each(totalTgtList, function() {
					var wk = this.YEAR_WEEK.split(" ")[1];
					parm.categories	.push(wk);
					parm.targetList	.push(this.TGT_ACCUMULATED_RECD);
					var recdMap = totalTgtMap[this.YEAR_WEEK];
					if(isValid(recdMap) && isValid(recdMap.SUM_SAVE_RECD)) lastRecd = recdMap.SUM_SAVE_RECD;
					parm.realList	.push(lastRecd);
				});
				
				<@pageId>.showChart(parm);
			});
		}
		,showChart : function(parm) {

			Highcharts.chart(parm.targetDomId, {
			    chart: {
			        type: 'line'
			    },
			    title: {
			        text: parm.title
			    },
			    xAxis: {
			        categories: parm.categories
			    },
			    yAxis: {
			    	 title: {
			    		 rotation : 0
			    		,x :  40
			    		,y : -20
			    		,align : "high"
			            ,text: parm.unitStr
			         }
			    },
			    plotOptions: {
			        line: {
			            dataLabels: {
			                enabled: true
			            },
			            enableMouseTracking: false
			        }
			    },
			    series: [
			    	 {
				         name: '목표'
				       	,color:'#888888'
				        ,data: parm.targetList
			    	 }
			    	,{
				        name: '실적'
				        ,data: parm.realList
			    	 }
			    ]
			});
			
		 }
		,testChart4 : function () {
			Highcharts.chart('container4', {

					title: {
						text: 'U.S Solar Employment Growth',
						align: 'left'
					},

					subtitle: {
						text: 'By Job Category. Source: <a href="https://irecusa.org/programs/solar-jobs-census/" target="_blank">IREC</a>.',
						align: 'left'
					},

					yAxis: {
						title: {
							text: 'Number of Employees'
						}
					},

					xAxis: {
						accessibility: {
							rangeDescription: 'Range: 2010 to 2020'
						}
					},

					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'middle'
					},

					plotOptions: {
						series: {
							label: {
								connectorAllowed: false
							},
							pointStart: 2010
						}
					},

					series: [{
						name: 'Installation & Developers',
						data: [43934, 48656, 65165, 81827, 112143, 142383,
							171533, 165174, 155157, 161454, 154610]
					}, {
						name: 'Manufacturing',
						data: [24916, 37941, 29742, 29851, 32490, 30282,
							38121, 36885, 33726, 34243, 31050]
					}, {
						name: 'Sales & Distribution',
						data: [11744, 30000, 16005, 19771, 20185, 24377,
							32147, 30912, 29243, 29213, 25663]
					}, {
						name: 'Operations & Maintenance',
						data: [null, null, null, null, null, null, null,
							null, 11164, 11218, 10077]
					}, {
						name: 'Other',
						data: [21908, 5548, 8105, 11248, 8989, 11816, 18274,
							17300, 13053, 11906, 10073]
					}],

					responsive: {
						rules: [{
							condition: {
								maxWidth: 500
							},
							chartOptions: {
								legend: {
									layout: 'horizontal',
									align: 'center',
									verticalAlign: 'bottom'
								}
							}
						}]
					}

					});
		}
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function() {
		alert("TTE$ST")
		<@pageId>.testChart1();
		<@pageId>.testChart4();

	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<div>
	hichart 입니다.<br/>
	<div id="execChart" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
	<div id="container1" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
	<div id="container2" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
	<div id="container4" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
</div>
