<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		testChart1 : function() {
		    Highcharts.chart('container1', {
		        title: {
		            text: "계획/실적"
		        },
		        exporting: {
		            buttons : {
		                contextButton : {
		                    enabled : false
		                }
		            }
		        },
		        xAxis: {
		            categories: ['4', '8', '12', '16', '20', '24', '28', '32', '36', '40', '44', '48', '52', '56', '80', '88', '96']
		        },
		        yAxis: {
		            min: -12,
		            max: 12,
		            title: {
		                text: 'Gap'
		            }
		        },
		        series: [{
		            type: 'line',
		            name: 'KP200',
		            color:'#FF0000',
		            data:  [1,2,3,4,5,6,7,8] // Max 100
		        }, {
		            type: 'line',
		            name: 'KD150',
		            color:'#00FF00',
		            data:  [-1,-2,-1,-2,-1,-2,-1,-2,-1,-2,-1,-2]  // Max 100
		        }, {
		            type: 'line',
		            name: 'T-GAP',
		            color:'#0000FF',
		            data:  [-1,2,-1,2,-1,-2,1,-2,-1,-2,-1,-2]  // Max 100
		        }]
		    });
		 }
		,testChart2 : function() {
			
		    Highcharts.chart('container2', {
		        chart: {
		            plotBackgroundColor: null,
		            plotBorderWidth: 0,
		            plotShadow: false
		        },
		        title: {
		            text: 'SSAIM'
		        },
		        exporting: {
		            buttons : {
		                contextButton : {
		                    enabled : false
		                }
		            }
		        },
		        tooltip: {
		            pointFormat: '{point.name}: {point.y}<b>({point.percentage:.1f}%)</b>'
		        },
		        plotOptions: {
		            pie: {
		                dataLabels: {
		                    enabled: true,
		                    distance: -30,
		                    style: {
		                        fontWeight: 'bold',
		                        color: 'white'
		                    }
		                },
		                startAngle: 0,
		                endAngle: 360,
		                center: ['50%', '50%'],
		                size: '100%'
		            }
		        },
		        series: [{
		            type: 'pie',
		            name: 'Share',
		            innerSize: '0%',
		            data: [
		                ['S', 158],
		                ['S', 213],
		                ['A', 130],
		                ['I', 213],
		                ['M', 119]
		            ],
		            dataLabels: {
		                formatter: function () {
		                    return this.y > 1 ? '<b>' + this.point.name + ':</b> ' + this.y + ' 건' : null;
		                }
		            }
		        }]
		    });
		 }
		,testChart3 : function() {
			var parm = {
				queryGroup : [
					 {
						 queryId 		: "Chart.getProjectChartTgtData"
						,requestParm	: {pjt_id : "1752fb2c2bf463a92000", kpi_type : "E"}
					 }
					,{
						 queryId 		: "Chart.getProjectChartRecdData"
						,requestParm	: {pjt_id : "1752fb2c2bf463a92000"}
					 }
				]
			}
			C_COM.requestQuery(parm, function(resultData) {
				var cTgtList 		= resultData.data["Chart.getProjectChartTgtData"];
				// Chart List에서 TOTAL정보만 가져옴
				var totalTgtList 	= fn_searchJsonObjectArray(cTgtList, "PART_CD", "TOTAL", "E");
				// WK 오름차순으로 정렬
				totalTgtList.orderBy("YEAR_WEEK", "ASC");
				
				var cRecdList 		= resultData.data["Chart.getProjectChartRecdData"];
				// Chart List에서 TOTAL정보만 가져옴
				var totalRecdList 	= fn_searchJsonObjectArray(cRecdList, "PART_CD", "TOTAL", "E");
				// 주차별 정보 Map 형태로 변환
				totalTgtMap		= arrayToMap(totalRecdList, "WK");
				
				var parm = {
					 targetDomId	: "execChart"
					,title 			: "실행기준"
					,categories		: []
					,unitStr		: "(억원/10K)"
					,targetList 	: []
					,realList 		: []
				}
				var lastRecd = 0;
				$.each(totalTgtList, function() {
					var wk = this.YEAR_WEEK.split(" ")[1];
					parm.categories	.push(wk);
					parm.targetList	.push(this.TGT_ACCUMULATED_RECD);
					var recdMap = totalTgtMap[this.YEAR_WEEK];
					if(isValid(recdMap) && isValid(recdMap.SUM_SAVE_RECD)) lastRecd = recdMap.SUM_SAVE_RECD;
					parm.realList	.push(lastRecd);
				});
				
				<@pageId>.showChart(parm);
			});
		}
		,showChart : function(parm) {

			Highcharts.chart(parm.targetDomId, {
			    chart: {
			        type: 'line'
			    },
			    title: {
			        text: parm.title
			    },
			    xAxis: {
			        categories: parm.categories
			    },
			    yAxis: {
			    	 title: {
			    		 rotation : 0
			    		,x :  40
			    		,y : -20
			    		,align : "high"
			            ,text: parm.unitStr
			         }
			    },
			    plotOptions: {
			        line: {
			            dataLabels: {
			                enabled: true
			            },
			            enableMouseTracking: false
			        }
			    },
			    series: [
			    	 {
				         name: '목표'
				       	,color:'#888888'
				        ,data: parm.targetList
			    	 }
			    	,{
				        name: '실적'
				        ,data: parm.realList
			    	 }
			    ]
			});
			
		 }
		,testChart4 : function () {
			Highcharts.chart('container4', {

					title: {
						text: 'U.S Solar Employment Growth',
						align: 'left'
					},

					subtitle: {
						text: 'By Job Category. Source: <a href="https://irecusa.org/programs/solar-jobs-census/" target="_blank">IREC</a>.',
						align: 'left'
					},

					yAxis: {
						title: {
							text: 'Number of Employees'
						}
					},

					xAxis: {
						accessibility: {
							rangeDescription: 'Range: 2010 to 2020'
						}
					},

					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'middle'
					},

					plotOptions: {
						series: {
							label: {
								connectorAllowed: false
							},
							pointStart: 2010
						}
					},

					series: [{
						name: 'Installation & Developers',
						data: [43934, 48656, 65165, 81827, 112143, 142383,
							171533, 165174, 155157, 161454, 154610]
					}, {
						name: 'Manufacturing',
						data: [24916, 37941, 29742, 29851, 32490, 30282,
							38121, 36885, 33726, 34243, 31050]
					}, {
						name: 'Sales & Distribution',
						data: [11744, 30000, 16005, 19771, 20185, 24377,
							32147, 30912, 29243, 29213, 25663]
					}, {
						name: 'Operations & Maintenance',
						data: [null, null, null, null, null, null, null,
							null, 11164, 11218, 10077]
					}, {
						name: 'Other',
						data: [21908, 5548, 8105, 11248, 8989, 11816, 18274,
							17300, 13053, 11906, 10073]
					}],

					responsive: {
						rules: [{
							condition: {
								maxWidth: 500
							},
							chartOptions: {
								legend: {
									layout: 'horizontal',
									align: 'center',
									verticalAlign: 'bottom'
								}
							}
						}]
					}

					});
		}
		,testChart_treemap : function () {
			
			//https://api.highcharts.com/highcharts/series.treemap
			
				const tmData = treemapData();
				Highcharts.chart('testChart_treemap', {
				    colorAxis: {
				        minColor: '#FFFFFF',
				        maxColor: '#4999AD'//Highcharts.getOptions().colors[0] 
				    },
				    series: [{
				        type: 'treemap',
				        layoutAlgorithm: 'squarified',   
				        alternateStartingDirection: true, 
				        levels: [{
				            level: 1,
				            layoutStartingDirection: 'vertical', // 세로로 정렬하도록 설정
				            layoutAlgorithm: 'squarified',
				            dataLabels: {
				                enabled: true,
				                align: 'center',
				                verticalAlign: 'middle',
				                style: {
				                    fontSize: '15px',
				                    fontWeight: 'lighter',
				                    color:'white',
				                    textOutline: 'none'

				                },
				                formatter: function () {
				                    return '<div style="text-align: center;">' + this.point.name +'</div><br><g>' + this.point.value + '%</div>';
				                }

				            }
				        }],
				        data: tmData
				    }],
				    title: {
				        text: ''
				    },
				    tooltip: {
				        pointFormat: '<b>{point.name}</b>:<br> {point.value}%<br>'
				    }
				})
				
				// 60%를 가운데로 하려고.
				$(".highcharts-br").attr("x",+$(".highcharts-br").attr("x")*10)
				
				function treemapData () {
					return [{
			            name: '월자문 컨설팅',
			            value: 60,
			            colorValue: 60
			        }, {
			            name: '일반 컨설팅',
			            value: 40,
			            colorValue: 40
			        }, {
			            name: '',
			            value: 0,
			            colorValue: 0
			        }, {
			            name: '',
			            value: 0,
			            colorValue: 0
			        }, {
			            name: '',
			            value: 0,
			            colorValue: 0
			        }, {
			            name: '',
			            value: 0,
			            colorValue: 0
			        }]  ;
				}
			
				
			}		
			,testChart_treemap2 : function () {
				
				const tmData = treemapData();
				Highcharts.chart('testChart_treemap2', {
				    colorAxis: {
				        minColor: '#FFFFFF',
				        maxColor: '#3C3E8A'
				    },
				    series: [{
				        type: 'treemap',
				        layoutAlgorithm: 'squarified',
				        alternateStartingDirection: true, 
				        levels: [{
				            level: 1,
				            layoutStartingDirection: 'vertical', // 세로로 정렬하도록 설정
				            layoutAlgorithm: 'squarified',
				            dataLabels: {
				                enabled: true,
				                align: 'center',
				                verticalAlign: 'middle',
				                style: {
				                    fontSize: '15px',
				                    fontWeight: 'lighter',
				                    color:'white',
				                    textOutline: 'none'

				                },
				                formatter: function () {
				                    return '<div style="text-align: center;">' + this.point.name +'</div><br><g>' + this.point.value + '%</div>';
				                }

				            }
				        }],
				        data: tmData
				    }],
				    title: {
				        text: ''
				    }
				})
				
				function treemapData () {
					return [{
			            name: '법인전환',
			            value: 50,
			            colorValue: 50,
			            dataLabels:[{}]
			        }, {
			            name: 'CEO 플랜',
			            value: 25,
			            colorValue: 25
			        }, {
			            name: '연구소 및 특허',
			            value: 12.5,
			            colorValue: 12.5
			        }, {
			            name: '정책자금',
			            value: 12.5,
			            colorValue: 13
			        }, {
			            name: '대출컨설팅',
			            value: 6.25,
			            colorValue: 6
			        }, {
			            name: '기타',
			            value: 6.25,
			            colorValue: 6
			        }]  ;
				}
			
				
			}
			,testChart_lineAndColumn : function () {
				
				Highcharts.setOptions({
					colors: ['#3C3E8A', '#DADADA']
				});
				const tmData = treemapData();

				Highcharts.chart('testChart_lineAndColumn', {
				    chart: {
				        zoomType: 'xy',
			            margin: [50, 0, 35, 45],
				    },
				    title: {
				        text: '',
				        align: 'left'
				    },

				    subtitle: {
/* 				        text: 'Source: ' +
				            '<a href="https://www.yr.no/nb/historikk/graf/5-97251/Norge/Troms%20og%20Finnmark/Karasjok/Karasjok?q=2021"' +
				            'target="_blank">YR</a>',
 */				        text: '',
 						align: 'left'
				    },
				    xAxis: [{
				    	labels: {
				            style: {
				                color: '#8A8C92',
				                fontFamily: 'Noto Sans KR',
				                fontSize: '11px'
				            }
				        },
				        lineColor: '#DADADA',				    	
				        categories: ['1월', '2월', '3월', '4월', '5월', '6월',
				            '7월', '8월', '9월', '10월', '11월', '12월'],
				        crosshair: true

				    }],
				    yAxis: [{ // Primary yAxis
				        labels: {
				            format: '{value}억',
				            style: {
				                color: '#8A8C92',
				                fontFamily: 'Noto Sans KR',
				                fontSize: '11px'
				            }
				        },
				        title: {
				            text: '',
				            //style: {
				            //    color: Highcharts.getOptions().colors[1]
				            //}
				        }
				    }, { // Secondary yAxis
				        title: {
				            text: '',
				            style: {
				                    }
				        },
				        labels: {
				        	 //format: '{value} mm',
				        	 format: '',
					            style: {
				                //color: Highcharts.getOptions().colors[0]
				                }
				        },
				        opposite: true
				    }],
				    tooltip: {
				        shared: true
				    },
				    legend: {
				        align: 'right',
				        x: 0,
				        verticalAlign: 'top',
				        y: 0,
				        //floating: true,
				        //backgroundColor:
				         //   Highcharts.defaultOptions.legend.backgroundColor || // theme
				           // 'rgba(255,255,255,0.25)'
				        itemStyle: {
							color: '#8A8C92',
							fontFamily: 'Noto Sans KR',
							fontSize: '11px'
						},
						symbolRadius:0,//범례 심볼 radius 지정
			          	symbolWidth:10,
			          	symbolHeight:10,
			          	x: 0,//가로 위치 지정.
			            y: -2,//세로 위치 지정.
				           
				    },
				    plotOptions: {//라인에 원표시 삭제
				        line:{
			        		marker: {
			                	enabled: false
			            	}
				        }
				    },
				    series: tmData
				});
				
				function treemapData () {
					return [{
						        name: '2023년',
						        type: 'column',
						        yAxis: 1,
						        data: [70, 140, 190, 180, 195, 240, 160, 140, 0,
						            0, 0, 0],
						        tooltip: {
						            valueSuffix: '억'
					        	}
				    		}
							,{
						        name: '2022년',
						        type: 'line',
						        data:  [155, 170, 185, 170, 160, 175, 165, 190, 160, 170, 160, 150],
						        tooltip: {
						            valueSuffix:'억'
				        		}
				    		}] ;
				}
			}
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function() {
/* 		<@pageId>.testChart1();
		<@pageId>.testChart4(); */
		<@pageId>.testChart_treemap();
		<@pageId>.testChart_treemap2();
		<@pageId>.testChart_lineAndColumn();
	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<style>
.treemap 
</style>
<div>
	hichart 입니다.<br/>
	
 
	<!-- 분류별 실적 -->
	<div class="cont_box center" style='margin-left:250px;width:50%;'>
		<h3>분류별 실적</h3>
		<div class="box_division_wrap">
			<div class="box_division blue">
				<div class="row_60"><span>월자문 컨설팅<br><em>60%</em></span></div>
				<div class="row_40"><span>일반 컨설팅<br><em>40%</em></span></div>
			</div>
			<div class="box_division purple">
				<div class="row_50"><span>법인전환<br><em>50%</em></span></div>
				<div class="row_50">
					<div class="col_50"><span>CEO 플랜<br><em>25%</em></span></div>
					<div class="col_50">
						<div class="row_25"><span>연구소  및 특허<br><em>12.5%</em></span></div>
						<div class="row_25">
							<div class="col_50"><span>정책자금<br><em>12.5%</em></span></div>
							<div class="col_50">
								<div class="row_15 back60"><span class="font10 lh12">대출컨설팅<br><em class="font14">6.25%</em></span></div>
								<div class="row_15 back50"><span class="font10 lh12">기타<br><em class="font14">6.25%</em></span></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="box_text">
			<div class="box_division">&lt; 대분류 &gt;</div>
			<div class="box_division">&lt; 소분류 &gt;</div>
		</div>
	</div>
	 			
	<!-- 분류별 실적 -->
	<div class="cont_box center" style='margin-left:250px;width:900px;;height:400px;'>
		<h3>분류별 실적</h3>
		<div class="box_division_wrap">
			<div id="testChart_treemap"  ></div>		
			<div id="testChart_treemap2" ></div>		
		</div>
		<div class="box_text">
			<div class="box_division">&lt; 대분류 &gt;</div>
			<div class="box_division">&lt; 소분류 &gt;</div>
		</div>
	</div>
 

<section class="sec_wrap">
	<div class="cont_box col3">
		<h3>전체 월자문 순매출 &lt; 본사 &gt;</h3>
		<div class="price">13,844,381,010원</div>
		<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

		<figure class="highcharts-figure">
	    	<div  id="testChart_lineAndColumn" class="chart" style="width:100%; height:280px; margin:0 auto"></div> 
		</figure>
	</div>
</section>





	
	
	
		
	<div id="execChart" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
	<div id="container1" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
	<div id="container2" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
	<div id="container4" style="min-width: 310px; height: 353px; margin: 5px auto 20px;"></div><br/>		
 
