<meta charset="utf-8">

<script type="text/javascript">
var <@pageId> = {
		
		mainCategoryItem: ''
		,categoryChart	: ()=> <@pageId>.mainCategoryChart()
		,treemapChart : (target, colorAxis, treemapData , func)=>_treemapChart(target, colorAxis, treemapData, func)
		,pageInit : () =>{
			
			const containerList 	= ["<@pageId>_monthlyOSP_chart"];
			const categoriesList 	= [['1월', '2월', '3월', '4월', '5월', '6월','7월', '8월', '9월', '10월', '11월', '12월']];
			const seriesList		= [[{
			        name: '2023년',
			        type: 'column',
			        yAxis: 1,
			        data: [70, 140, 190, 180, 195, 240, 160, 140, 0,
			            0, 0, 0],
			        tooltip: {
			            valueSuffix: '억'
		        	}
				}
				,{
			        name: '2022년',
			        type: 'line',
			        data:  [155, 170, 185, 170, 160, 175, 165, 190, 160, 170, 160, 150],
			        tooltip: {
			            valueSuffix:'억'
		    		}
				}]]
			
			
			containerList.forEach( (chart,idx) =>{
				
				<@pageId>.createChart( containerList[idx] , categoriesList[idx] , seriesList[idx] );
				
			})
		}
		,mainCategoryChart :  () => {
		
			var parm = {
					 queryId 		: "rstMgn.getConsultingTypeList"
					,requestParm	: {SUB_CATEGORY:""}
			}

			C_COM.requestQuery(parm, function(resultData) {

				const treemapData = resultData.data.map( (row,idx) => {

					if( idx == 0 )<@pageId>.mainCategoryItem = row.CONSULTING_TYPE;
					return {
						type: row.CONSULTING_TYPE,
			            name: row.CONSULTING_TYPE_NM,
			            value: row.COLOR_VALUE,
			            colorValue: row.COLOR_VALUE
					}
					
				})

				<@pageId>.treemapChart('<@pageId>_mainCategoryTreemap',{	minColor: '#75C2D5',
													        	maxColor: '#3BA8C3'},
													        	treemapData,function(options){
													        		console.log( options );
													        		<@pageId>.mainCategoryItem = options.type;
													        		<@pageId>.subCategoryTreemap();
													        	});
				<@pageId>.subCategoryTreemap();
			});
			
		}		
		,subCategoryTreemap :  () => {

			const requestParm = {
					SUB_CATEGORY:<@pageId>.mainCategoryItem
			};
			
			var parm = {
					 queryId 		: "rstMgn.getConsultingTypeList"
					,requestParm	: requestParm
			}

			C_COM.requestQuery(parm, function(resultData) {

				const treemapData = resultData.data.map( row => {
					
					return {
			            name: row.CONSULTING_NM,
			            value: row.COLOR_VALUE,
			            colorValue: row.COLOR_VALUE
					}
					
				})

				<@pageId>.treemapChart('<@pageId>_subCategoryTreemap',{	minColor: '#8A8BB9',
													        	maxColor: '#27187F'},treemapData);
				

				$(".highcharts-credits").remove();
				$(".highcharts-legend.highcharts-no-tooltip").remove();
			});	
	
		}
		,contractList :  () => {

			const requestParm = {
					FROM_CONTRACT_DATE:''
					,TO_CONTRACT_DATE:''
			};
			
			var parm = {
					 queryId 		: "rstMgn.getContractList"
					,requestParm	: requestParm
			}

			C_COM.requestQuery(parm, function(resultData) {
				
				var rparm = {
						 targetId 		: "<@pageId>_contractList"
						,list			: resultData.data
				}
			
				C_COM.renderHtml("<@pageId>", rparm);
			
			});	
	
		}	
		
		,createChart : (container, categories, series)=>_createChart(container, categories, series)
}
// Page Load가 완료된후 실행 된다.
C_PM.onLoadPage("<@pageId>", function() {

	<@pageId>.pageInit();
	<@pageId>.categoryChart();
	<@pageId>.contractList();
	

	
});
// History back으로 이동해왔을 경우 이루틴이 실행된다.
C_HM.onReturn("<@pageId>", function(pageId, data) {

});
</script>
<div class="cont_wrap">
			<div class="cont_top">
				<h2><i class="icon_bullet"></i>Main</h2>

				<div class="select_box fr" style="width:132px">
					<button type="button" class="btn radio"><span>전체</span></button>
                    <ul class="select_lst">
                    </ul>
                </div>
			</div>
			<div class="sec_scroll">
				<section class="sec_wrap">
				<!-- 분류별 실적 -->
				<div class="cont_box left" style='width:29%;overflow:hidden'>
					<h3>분류별 실적</h3>
					<div class="box_division_wrap" style='margin-top:0px;'>
						<div style='width:50%;'>
							<div id="<@pageId>_mainCategoryTreemap"  style='height:350px;' ></div>
						</div>
						<div style='width:50%;'>
				 			<div id="<@pageId>_subCategoryTreemap"  style='height:350px;' ></div>
						</div>		
					</div>
					<div class="box_text">
						<div class="box_division" style='z-index:10'>&lt; 대분류 &gt;</div>
						<div class="box_division" style='z-index:10'>&lt; 소분류 &gt;</div>
					</div>
				</div>

					<!-- 전체 계약 리스트 -->
					<div class="cont_box right">
						<h3>전체 계약 리스트</h3>
						<!-- search area -->
						<div class="search_area">
							<span class="tit01">조회기간</span>
							<div class="calendar_wrap">
								<input type="text" class="datepicker" style="width:132px">
							</div>
							<div class="search_right">
								<button type="button" class="btn fl"><i class="icon_download"></i> Excel 다운로드</button>
								<div class="select_box fl" style="width:132px">
									<button type="button" class="btn radio"><span>50개 보기</span></button>
				                    <ul class="select_lst">
				                    </ul>
				                </div>
				            </div>
						</div>
						<!-- 테이블 -->
						<div class="tbl01 col">
							<table>
								<caption>표 캡션</caption>
								<colgroup>
									<col style="width:40px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:60px;"/>
									<col style="width:11%;"/>
									<col style="width:11%;"/>
									<col style="width:16%;"/>
									<col style="width:9%;"/>
									<col style="width:9%;"/>
								</colgroup>
								<thead>
									<tr>
										<th scope="col"><input type="checkbox"></th>
										<th scope="col">년</th>
										<th scope="col">월</th>
										<th scope="col">팀</th>
										<th scope="col">유입<br>경로</th>
										<th scope="col">구분</th>
										<th scope="col">담당자</th>
										<th scope="col">사업자 등록번호</th>
										<th scope="col">거래처</th>
										<th scope="col">컨설팅명</th>
										<th scope="col">총 계액금액</th>
										<th scope="col">입금액</th>
									</tr>
								</thead>
								<tbody id="<@pageId>_contractList">
								</tbody>
<script type="text/x-jsrender" id="<@pageId>_contractList_template">						
						{{for list}}
							<tr name="<@pageId>_tr_{{:#index}}"                          value='{{:CONTRACT_ID}}'>
								<td><input type='checkbox' id="<@pageId>_ck_{{:#index}}" value='{{:CONTRACT_ID}}'></td>
			 					<td id='CONTRACT_YEAR'		value='{{:CONTRACT_YEAR}}'		>{{:CONTRACT_YEAR}}</td>
			 					<td id='CONTRACT_MONTH'		value='{{:CONTRACT_MONTH}}'		>{{:CONTRACT_MONTH}}</td>
			 					<td id='SALES_TYPE_NM'		value='{{:SALES_TYPE_NM}}'		>{{:SALES_TYPE_NM}}</td>
			 					<td id='GET_PATH_NM'		value='{{:GET_PATH_NM}}'		>{{:GET_PATH_NM}}</td>
			 					<td id='CONTRACT_TYPE_NM'	value='{{:CONTRACT_TYPE_NM}}'	>{{:CONTRACT_TYPE_NM}}</td>
			 					<td id='USER_NM'			value='{{:USER_NM}}'			>{{:USER_NM}}</td>
								<td id='COMPANY_REGNUM' 	value='{{:COMPANY_REGNUM}}'		>{{:COMPANY_REGNUM}}</td>
								<td id='BUYER_NM'			value='{{:BUYER_NM}}'			>{{:BUYER_NM}}</td>
								<td id='CONSULTING_NM'		value='{{:CONSULTING_NM}}'		>{{:CONSULTING_NM}}</td>
 								<td id='TOTAL_COST'			value='{{:TOTAL_COST}}'			>{{:TOTAL_COST}}</td>
 								<td id='TOT_INCOME'			value='{{:TOT_INCOME}}'				>{{:TOT_INCOME}}</td>
							</tr>
						{{/for}}
</script>
<script type="text/x-jsrender" id="<@pageId>_contractList_noData_template">	
				<tr>	
					<td colspan=12>자료가 없습니다.</td>	
				</tr>
</script>								
							</table>
						</div>
						<!-- paging -->
						<div class="paging">
							<a href="#none" class="btn_pg_first disabled">첫번째 페이지</a>
							<a href="#none" class="btn_pg_prev disabled">이전 페이지</a>
							<strong title="현재 페이지">1</strong>
							<a href="#none">2</a>
							<a href="#none">3</a>
							<a href="#none">4</a>
							<a href="#none">5</a>
							<a href="#none" class="btn_pg_next">다음 페이지</a>
							<a href="#none" class="btn_pg_last">마지막 페이지</a>
						</div>
					</div>
				</section>

				<section class="sec_wrap">
					<div class="cont_box col3" id="<@pageId>_monthly_OrgSellingPrice">
						<h3>전체 월자문 순매출 &lt; 본사 &gt;</h3>
						<div class="price" >13,844,381,010원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart" id="<@pageId>_monthlyOSP_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
					<div class="cont_box col3"  id="<@pageId>_once_OrgSellingPrice">
						<h3>전체 1회성 컨설팅 순매출 &lt; 본사 &gt;</h3>
						<div class="price"> 11,654,165,841원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart2" id="<@pageId>_onceOSP_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
					<div class="cont_box col3" id="<@pageId>_product_OrgSellingPrice">
						<h3>전체 컨설팅 상세별 순매출 &lt; 본사 &gt;</h3>
						<div class="price" >11,654,165,841원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart3" id="<@pageId>_productOSP_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
				</section>

				<section class="sec_wrap">
					<div class="cont_box col2" id="<@pageId>_monthlyPayment_Price">
						<h3>전체 월자문 수수료 지급 &lt; FA &gt;</h3>
						<div class="price" >13,844,381,010원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart4" id="<@pageId>_monthlyPayment_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
					<div class="cont_box col2" id="<@pageId>_oncePayment_Price">
						<h3>전체 1회성 컨설팅 수수료 지급 &lt; FA &gt;</h3>
						<div class="price">11,435,843,123원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart5"  id="<@pageId>_oncePayment_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
				</section>

				<section class="sec_wrap">
					<div class="cont_box col2"  id="<@pageId>_org_selling_price_growthRate">
						<h3>전체 순매출 성장률</h3>
						<div class="price">265,465,879,132원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart6" id="<@pageId>_OSP_growthRate_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
					<div class="cont_box col2"  id="<@pageId>_org_selling_price_local">
						<h3>전체 지사별 순매출</h3>
						<div class="price">132,645,921,735원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart7"  id="<@pageId>_OSP_local_chart"style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
				</section>

				<section class="sec_wrap">
					<div class="cont_box col2" id="<@pageId>_monthly_contract_cnt">
						<h3>전체 월자문 계약건수</h3>
						<div class="price">13,844,381,010원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart8" id="<@pageId>_monthlyContractCnt_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
					<div class="cont_box col2"  id="<@pageId>_fa_selling_rank">
						<h3>전체 FA 매출순위</h3>
						<div class="price">13,844,381,010원</div>
						<span class="prepare">전월 대비</span><span class="percent">+2.2%</span>

						<figure class="highcharts-figure">
					    	<div class="chart9" id="<@pageId>_faSellingRank_chart" style="width:100%; height:280px; margin:0 auto"></div>
						</figure>
					</div>
				</section>

				<section class="sec_wrap">
					<div class="cont_box">
						<h3>전체 월자문 계약 현황</h3>
						<!-- search area -->
						<div class="search_area">
							<span class="tit01">조회기간</span>
							<div class="calendar_wrap">
								<input type="text" class="datepicker" style="width:132px">
							</div>
							<div class="search_right">
								<div class="select_box fl" style="width:132px">
									<button type="button" class="btn radio"><span>50개 보기</span></button>
				                    <ul class="select_lst">
				                        <li>
				                            <input name="number" id="num01_01" type="radio" value="">
				                            <label for="num01_01">50개 보기<i class="icon_check"></i></label>
				                        </li>
				                        <li>
				                            <input name="number" id="num01_02" type="radio" value="">
				                            <label for="num01_02">30개 보기<i class="icon_check"></i></label>
				                        </li>
				                        <li>
				                            <input name="number" id="num01_03" type="radio" value="">
				                            <label for="num01_03">10개 보기<i class="icon_check"></i></label>
				                        </li>
				                    </ul>
				                </div>
				            </div>
						</div>
						<!-- 테이블 -->
						<div class="tbl01 col">
							<table>
								<caption>표 캡션</caption>
								<colgroup>
									<col style="width:40px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:60px;"/>
									<col style="width:11%;"/>
									<col style="width:11%;"/>
									<col style="width:15%;"/>
									<col style="width:9%;"/>
									<col style="width:9%;"/>
								</colgroup>
								<thead>
									<tr>
										<th scope="col"><input type="checkbox"></th>
										<th scope="col">년</th>
										<th scope="col">월</th>
										<th scope="col">팀</th>
										<th scope="col">유입<br>경로</th>
										<th scope="col">구분</th>
										<th scope="col">담당자</th>
										<th scope="col">사업자 등록번호</th>
										<th scope="col">거래처</th>
										<th scope="col">컨설팅명</th>
										<th scope="col">총 계액금액</th>
										<th scope="col">입금액</th>
									</tr>
								</thead>
								<tbody id="<@pageId>_monthlyContractList">
								</tbody>
<script type="text/x-jsrender" id="<@pageId>_monthlyContractList_template">						
						{{for list}}
							<tr name="<@pageId>_tr_{{:#index}}"                          value='{{{:BUYER_ID}}'>
								<td><input type='checkbox' id="<@pageId>_ck_{{:#index}}" value='{{:BUYER_ID}}'></td>
			 					<td id='CONTRACT_YEAR'	value='{{:CONTRACT_YEAR}}'		>{{:CONTRACT_YEAR}}</td>
			 					<td id='CONTRACT_MONTH'	value='{{:CONTRACT_MONTH}}'		>{{:CONTRACT_MONTH}}</a></td>
			 					<td id='SALES_TYPE_NM'		value='{{:SALES_TYPE_NM}}'		>{{:SALES_TYPE_NM}}</td>
			 					<td id='GET_PATH_NM'		value='{{:GET_PATH_NM}}'		>{{:GET_PATH_NM}}</td>
			 					<td id='CONTRACT_TYPE_NM'	value='{{:CONTRACT_TYPE_NM}}'	>{{:CONTRACT_TYPE_NM}}</td>
			 					<td id='USER_NM'			value='{{:USER_NM}}'			>{{:USER_NM}}</td>
								<td id='COMPANY_REGNUM' 	value='{{:COMPANY_REGNUM}}'		>{{:COMPANY_REGNUM}}</td>
								<td id='BUYER_NM'			value='{{:BUYER_NM}}'			>{{:BUYER_NM}}</td>
								<td id='CONSULTING_NM'		value='{{:CONSULTING_NM}}'		>{{:CONSULTING_NM}}</td>
 								<td id='TOTAL_COST'			value='{{:TOTAL_COST}}'			>{{:TOTAL_COST}}</td>
 								<td id='TOT_INCOME'			value='{{:TOT_INCOME}}'				>{{:TOT_INCOME}}</td>
							</tr>
					{{/for}}
</script>
<script type="text/x-jsrender" id="<@pageId>_monthlyContractList_noData_template">	
				<tr>	
					<td colspan=12>자료가 없습니다.</td>	
				</tr>
</script>

							</table>
						</div>
						<!-- paging -->
						<div class="paging">
							<a href="#none" class="btn_pg_first disabled">첫번째 페이지</a>
							<a href="#none" class="btn_pg_prev disabled">이전 페이지</a>
							<strong title="현재 페이지">1</strong>
							<a href="#none">2</a>
							<a href="#none">3</a>
							<a href="#none">4</a>
							<a href="#none">5</a>
							<a href="#none" class="btn_pg_next">다음 페이지</a>
							<a href="#none" class="btn_pg_last">마지막 페이지</a>
						</div>
					</div>
				</section>

				<section class="sec_wrap">
					<div class="cont_box">
						<h3>전체 1회성 컨설팅 매출 현황</h3>
						<!-- search area -->
						<div class="search_area">
							<span class="tit01">조회기간</span>
							<div class="calendar_wrap">
								<input type="text" class="datepicker" style="width:132px">
							</div>
							<div class="search_right">
								<div class="select_box fl" style="width:132px">
									<button type="button" class="btn radio"><span>50개 보기</span></button>
				                    <ul class="select_lst">
				                        <li>
				                            <input name="number" id="num02_01" type="radio" value="">
				                            <label for="num02_01">50개 보기<i class="icon_check"></i></label>
				                        </li>
				                        <li>
				                            <input name="number" id="num02_02" type="radio" value="">
				                            <label for="num02_02">30개 보기<i class="icon_check"></i></label>
				                        </li>
				                        <li>
				                            <input name="number" id="num02_03" type="radio" value="">
				                            <label for="num02_03">10개 보기<i class="icon_check"></i></label>
				                        </li>
				                    </ul>
				                </div>
				            </div>
						</div>
						<!-- 테이블 -->
						<div class="tbl01 col">
							<table>
								<caption>표 캡션</caption>
								<colgroup>
									<col style="width:40px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:55px;"/>
									<col style="width:60px;"/>
									<col style="width:11%;"/>
									<col style="width:11%;"/>
									<col style="width:15%;"/>
									<col style="width:9%;"/>
									<col style="width:9%;"/>
								</colgroup>
								<thead>
									<tr>
										<th scope="col"><input type="checkbox"></th>
										<th scope="col">년</th>
										<th scope="col">월</th>
										<th scope="col">팀</th>
										<th scope="col">유입<br>경로</th>
										<th scope="col">구분</th>
										<th scope="col">담당자</th>
										<th scope="col">사업자 등록번호</th>
										<th scope="col">거래처</th>
										<th scope="col">컨설팅명</th>
										<th scope="col">총 계액금액</th>
										<th scope="col">입금액</th>
									</tr>
								</thead>
								<tbody id="<@pageId>_onceContractList">
								</tbody>
<script type="text/x-jsrender" id="<@pageId>_monthlyContractList_template">						
						{{for list}}
							<tr name="<@pageId>_tr_{{:#index}}"                          value='{{:CONTRACT_ID}}'>
								<td><input type='checkbox' id="<@pageId>_ck_{{:#index}}" value='{{:CONTRACT_ID}}'></td>
			 					<td id='CONTRACT_YEAR'		value='{{:CONTRACT_YEAR}}'		>{{:CONTRACT_YEAR}}</td>
			 					<td id='CONTRACT_MONTH'		value='{{:CONTRACT_MONTH}}'		>{{:CONTRACT_MONTH}}</a></td>
			 					<td id='SALES_TYPE_NM'		value='{{:SALES_TYPE_NM}}'		>{{:SALES_TYPE_NM}}</td>
			 					<td id='GET_PATH_NM'		value='{{:GET_PATH_NM}}'		>{{:GET_PATH_NM}}</td>
			 					<td id='CONTRACT_TYPE_NM'	value='{{:CONTRACT_TYPE_NM}}'	>{{:CONTRACT_TYPE_NM}}</td>
			 					<td id='USER_NM'			value='{{:USER_NM}}'			>{{:USER_NM}}</td>
								<td id='COMPANY_REGNUM' 	value='{{:COMPANY_REGNUM}}'		>{{:COMPANY_REGNUM}}</td>
								<td id='BUYER_NM'			value='{{:BUYER_NM}}'			>{{:BUYER_NM}}</td>
								<td id='CONSULTING_NM'		value='{{:CONSULTING_NM}}'		>{{:CONSULTING_NM}}</td>
 								<td id='TOTAL_COST'			value='{{:TOTAL_COST}}'			>{{:TOTAL_COST}}</td>
 								<td id='TOT_INCOME'			value='{{:TOT_INCOME}}'			>{{:TOT_INCOME}}</td>
							</tr>
					{{/for}}
</script>
<script type="text/x-jsrender" id="<@pageId>_monthlyContractList_noData_template">	
				<tr>	
					<td colspan=12>자료가 없습니다.</td>	
				</tr>
</script>
							</table>
						</div>
						<!-- paging -->
						<div class="paging">
							<a href="#none" class="btn_pg_first disabled">첫번째 페이지</a>
							<a href="#none" class="btn_pg_prev disabled">이전 페이지</a>
							<strong title="현재 페이지">1</strong>
							<a href="#none">2</a>
							<a href="#none">3</a>
							<a href="#none">4</a>
							<a href="#none">5</a>
							<a href="#none" class="btn_pg_next">다음 페이지</a>
							<a href="#none" class="btn_pg_last">마지막 페이지</a>
						</div>
					</div>
				</section>
			</div>
		</div>