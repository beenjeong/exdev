<meta charset="utf-8">
<script type="text/javascript">
var <@pageId> = {
		selectedData : []
		,pageInit : () =>{
			
		}
		,searchList : () => {
			
			const requestParm = {};
			
			var parm = {
					 queryId 		: "salary.getPaymentCntList"
					,requestParm	: requestParm
			}

			C_COM.requestQuery(parm, function(resultData) {
				var rparm = {
						 targetId 		: "<@pageId>_paymentCntList"
						,list			: resultData.data
				}
				<@pageId>.selectedData = resultData.data;
				C_COM.renderHtml("<@pageId>", rparm);
			});
		}
		,rowClick : (obj) => {
			debugger;
			const index =  $(obj).attr("index");
			const selectedRow = <@pageId>.selectedData[index];
			
			const requestParm =  {USER_ID : selectedRow.USER_ID}
			
			var parm = {
					 queryId 		: "salary.getPaymentDetailList"
					,requestParm	: requestParm
			}

			C_COM.requestQuery(parm, function(resultData) {
				var rparm = {
						 targetId 		: "<@pageId>_paymentDetailList"
						,list			: resultData.data
				}
				C_COM.renderHtml("<@pageId>", rparm);
				
				let sumTotalCost=0,sumIncome=0,sumPayment=0;
				resultData.data.forEach(item=>{
					sumTotalCost 	+=item.TOTAL_COST;
					sumIncome		+=item.INCOME;
					sumPayment		+=item.PAYMENT;
				})

				$("#sumTotalCost").text(sumTotalCost.toLocaleString());
				$("#sumIncome").text(sumIncome.toLocaleString());
				$("#sumPayment").text(sumPayment.toLocaleString());
			});			
		}
}
// Page Load가 완료된후 실행 된다.
C_PM.onLoadPage("<@pageId>", function() {

	<@pageId>.pageInit();
	<@pageId>.searchList();
	
});
// History back으로 이동해왔을 경우 이루틴이 실행된다.
C_HM.onReturn("<@pageId>", function(pageId, data) {

});
</script>
	
<div class="cont_wrap backWhite">
	<div class="cont_top">
		<h2><i class="icon_bullet"></i>급여관리</h2>
	</div>
	<section class="sec_wrap list" style="height:calc(100% - 43px);">
		<!-- search area -->
		<div class="search_area mt0">
			<div class="fl">
				<!-- 실글 선택 -->
				<div class="select_box fl" style="width:110px">
					<button type="button" class="btn radio"><span>2024년</span></button>
<!--                     <ul class="select_lst">
                        <li>
                            <input name="year" id="year01" type="radio" value="">
                            <label for="year01">2024년<i class="icon_check"></i></label>
                        </li>
                        <li>
                            <input name="year" id="year02" type="radio" value="">
                            <label for="year02">2025년<i class="icon_check"></i></label>
                        </li>
                        <li>
                            <input name="year" id="year03" type="radio" value="">
                            <label for="year03">2026년<i class="icon_check"></i></label>
                        </li>
                    </ul> -->
                </div>
                <!-- 실글 선택 -->
				<div class="select_box fl" style="width:90px">
					<button type="button" class="btn radio"><span>01월</span></button>
<!--                     <ul class="select_lst">
                        <li>
                            <input name="month" id="month01" type="radio" value="">
                            <label for="month01">01월<i class="icon_check"></i></label>
                        </li>
                        <li>
                            <input name="month" id="month02" type="radio" value="">
                            <label for="month02">02월<i class="icon_check"></i></label>
                        </li>
                        <li>
                            <input name="month" id="month03" type="radio" value="">
                            <label for="month03">03월<i class="icon_check"></i></label>
                        </li>
                    </ul> -->
                </div>
                <span class="tit01 fl lh33">사원선택</span>
                <div class="search_inputWrap fl">
					<input type="search" name=""><button class="search_btn"><i class="icon_search"></i></button>
				</div>
				<button class="btn select fl">검색</button>
            </div>
		</div>
		<div class="clearFix mt15" style="height: calc(100% - 53px);">
			<div class="fl h100 mr15" style="width:calc(35% - 15px);">
				<div class="cont_top clearFix">
					<h3 class="fl font16">급여 내역 리스트</h3>
					<div class="fr"><strong class="total">Total: <span class="<@pageId>_pointColr">3</span></strong></div>
				</div>

				<!-- 테이블 -->
				<div class="tbl01 col tbl_scroll line" style="height:calc(100% - 30px);">
					<div class="tbl01 col tbl_head">
						<table>
							<caption>급여 내역 리스트</caption>
							<colgroup>
								<col style="width:45px;"/>
								<col style="width:120px;"/>
								<col style="width:120px;"/>
								<col style="width:120px;"/>
								<col style="width:120px;"/>
							</colgroup>
							<thead>
								<tr>
									<th scope="col">No.</th>
									<th scope="col">정산년월</th>
									<th scope="col">사원명</th>
									<th scope="col">관련계약건수</th>
									<th scope="col">수수료 합</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="tbl01 col tbl_body_scroll">
						<table>
							<caption>급여 내역 리스트</caption>
							<colgroup>
								<col style="width:45px;"/>
								<col style="width:120px;"/>
								<col style="width:120px;"/>
								<col style="width:120px;"/>
								<col style="width:120px;"/>
							</colgroup>
							<tbody  id="<@pageId>_paymentCntList">
							</tbody>
 							<script type="text/x-jsrender" id="<@pageId>_paymentCntList_template">						
								{{for list}}
									<tr name="<@pageId>_tr_{{:#index}}"  	onclick="javascript:<@pageId>.rowClick(this)" index="{{:#index}}">
										<td id='RN'							>{{:RN}}</td>
										<td id='CALC_PAY_DATE'				>{{:CALC_PAY_DATE}}</td>
										<td id='USER_NM'					>{{:USER_NM}}</td>
										<td id='CNT'			class="tr"	>{{numb:CNT}}</td>
										<td id='TOTAL_PAYMENT'	class="tr"	>{{numb:TOTAL_PAYMENT}}</td>
									</tr>
								{{/for}}
							</script>
							<script type="text/x-jsrender" id="<@pageId>_paymentCntList_noData_template">	
								<tr>	
									<td colspan=5>자료가 없습니다.</td>	
								</tr>
							</script>
						</table>
					</div>
				</div>
			</div>
			<div class="fl h100 ml15" style="width:calc(65% - 15px);">
				<div class="cont_top clearFix">
					<h3 class="fl font16">급여 상세</h3>
					<div class="fr">
						<span class="info"><strong>위성열</strong> l <strong>2024년 01월</strong> l</span>
						<strong class="total">Total: <span class="pointColr">3</span></strong>
					</div>
				</div>
				<!-- 테이블 -->
				<div class="tbl01 col tbl_scroll row2" style="height:calc(100% - 30px);">
					<div class="tbl01 col tbl_head2">
						<table>
							<caption>급여관리 리스트</caption>
							<colgroup>
								<col style="width:40px;"/>
								<col style="width:120px;" span="4"/>
								<col style="width:100px;" span="3"/>
								<col style="width:100px;"/>
							</colgroup>
							<thead>
								<tr>
									<th scope="col" rowspan="2">No.</th>
									<th scope="col" colspan="3">계약정보</th>
									<th scope="col" rowspan="2">실적/입금액</th>
									<th scope="col" rowspan="2">입금일</th>
									<th scope="col" rowspan="2">계약관례Type</th>
									<th scope="col" rowspan="2">수수료율</th>
									<th scope="col" rowspan="2">수수료</th>
								</tr>
								<tr>
									<th scope="col">고객명</th>
									<th scope="col">컨설팅명</th>
									<th scope="col">총계약금액</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="tbl01 col tbl_body_scroll2">
						<table>
							<caption>급여관리 리스트</caption>
							<colgroup>
								<col style="width:40px;"/>
								<col style="width:120px;" span="4"/>
								<col style="width:100px;" span="3"/>
								<col style="width:100px;"/>
							</colgroup>
							<tbody  id="<@pageId>_paymentDetailList">
							</tbody>
 							<script type="text/x-jsrender" id="<@pageId>_paymentDetailList_template">						
								{{for list}}
									<tr name="<@pageId>_tr_{{:#index}}"  	onclick="javascript:<@pageId>.rowClick(this)" index="{{:#index}}">
										<td id='RN'							>{{:RN}}</td>
										<td id='USER_NM'					>{{:USER_NM}}</td>
										<td id='CONSULTING_NM'				>{{:CONSULTING_NM}}</td>
										<td id='TOTAL_COST'	class="tr"		>{{numb:TOTAL_COST}}</td>
										<td id='INCOME'		class="tr"		>{{numb:INCOME}}</td>
										<td id='RESULT_DATE'class="tc"		>{{:RESULT_DATE}}</td>
										<td id='RELATION_TYPE_NM' class="tc">{{:RELATION_TYPE_NM}}</td>
										<td id='RATE'						>{{:RATE}}</td>
										<td id='PAYMENT' class="tr"			>{{numb:PAYMENT}}</td>
									</tr>
								{{/for}}
							</script>
							<script type="text/x-jsrender" id="<@pageId>_paymentDetailList_noData_template">	
								<tr>	
									<td colspan=5>자료가 없습니다.</td>	
								</tr>
							</script>
							<tfoot>
								<tr>
									<td></td>
									<td colspan="2" >총계</td>
									<td class="tr" id="sumTotalCost"></td>
									<td class="tr" id="sumIncome"></td>
									<td colspan="3"></td>
									<td class="tr" id="sumPayment"></td>
								</tr>
							</tfoot>
						</table>
					</div>
				</div>
			</div>
		</div>

	</section>
</div>
	