<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		 teamList		: []
		,teamMemberList	: []
		,loadData : function() {
			var parm = {
				 queryId 		: "operation.getTeamList"
				,requestParm	: {}
			}

			C_COM.requestQuery(parm, function(resultData) {
				
				<@pageId>.teamList = resultData.data;
				
				
				var parm = {
					 targetId 		: "<@pageId>_teamList"
					,list			: resultData.data
					,targetTotalId	: "totalCnt"
				}
				C_COM.renderHtml("<@pageId>", parm);
			});
			
		 }
		,selectTeam : function(idx) {
			let teamItem = <@pageId>.teamList[idx];
			
			var parm = {
				 queryId 		: "operation.getTeamMemberList"
				,requestParm	: teamItem
			}

			C_COM.requestQuery(parm, function(resultData) {
				
				<@pageId>.teamMemberList = resultData.data;
				
				var parm = {
					 targetId 		: "<@pageId>_teamMemberList"
					,list			: resultData.data
					,targetTotalId	: "totalMemberCnt"
				}
				C_COM.renderHtml("<@pageId>", parm);
				
				$("#<@pageId> #teamNm").html(teamItem.TEAM_NM);
				
			});
				
		 }
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function() {
		<@pageId>.loadData();
	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<div class="cont_wrap backWhite">
	<div class="cont_top">
		<h2><i class="icon_bullet"></i>팀관리</h2>
	</div>
	<section class="sec_wrap list" style="height:calc(100% - 43px);">
		<!-- search area -->
		<div class="search_area mt0">
			<div class="fl">
                <span class="tit01 fl lh33">사원선택</span>
                <div class="search_inputWrap fl">
					<input type="search" name=""><button class="search_btn"><i class="icon_search"></i></button>
				</div>
				<button class="btn select fl">검색</button>
            </div>
		</div>
		<div class="clearFix mt15" style="height: calc(100% - 53px);">
			<div class="fl h100 mr15" style="width:calc(50% - 25px);">
				<div class="cont_top clearFix">
					<h3 class="fl font16 lh33">팀목록</h3>
					<button class="btn select fl">추가</button>
					<div class="fr"><strong class="total">Total: <span class="pointColr" id="totalCnt"></span></strong></div>
				</div>

				<!-- 테이블 -->
				<div class="tbl01 col tbl_scroll" style="height:calc(100% - 30px);">
					<table>
						<caption>팀 리스트</caption>
						<colgroup>
							<col style="width:45px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
						</colgroup>
						<thead>
							<tr>
								<th scope="col">No.</th>
								<th scope="col">팀명</th>
								<th scope="col">팀명수</th>
								<th scope="col">생년일</th>
								<th scope="col">소속지사명</th>
								<th scope="col">관리</th>
							</tr>
						</thead>
						<tbody id="<@pageId>_teamList">
						</tbody>
						<script type="text/x-jsrender" id="<@pageId>_teamList_template">						
							{{for list}}
							<tr onclick="<@pageId>.selectTeam({{:#index}})">
								<td>{{:#index + 1}}</td>
								<td>{{:TEAM_NM}}</td>
								<td>{{:MEMBER_CNT}}</td>
								<td>{{:UPDATE_DATE}}</td>
								<td>{{:BRANCH_NM}}</td>
								<td>
									<a href=""><i class="icon_pen"></i></a>
									<a href=""><i class="icon_trash"></i></a>
								</td>
							</tr>
							{{/for}}
						</script>
						<script type="text/x-jsrender" id="<@pageId>_teamList_noData_template">	
							<tr>	
								<td colspan=6>자료가 없습니다.</td>	
							</tr>
						</script>
					</table>
				</div>
			</div>
			<div class="fl h100 ml15" style="width:calc(50% - 15px);">
				<div class="cont_top clearFix">
					<h3 class="fl font16 lh33"><span id="teamNm"></span> Member List</h3>
					<div class="fr">
						<strong class="total">Total: <span class="pointColr" id="totalMemberCnt">3</span></strong>
					</div>
				</div>
				<!-- 테이블 -->
				<div class="tbl01 col tbl_scroll" style="height:calc(100% - 30px);">
					<table>
						<caption>스타 A팀 Member List</caption>
						<colgroup>
							<col style="width:45px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
							<col style="width:120px;"/>
						</colgroup>
						<thead>
							<tr>
								<th scope="col">No.</th>
								<th scope="col">팀원ID</th>
								<th scope="col">팀원명</th>
								<th scope="col">역할</th>
								<th scope="col">등급</th>
							</tr>
						</thead>
						<tbody id="<@pageId>_teamMemberList">
							<tr>	
								<td colspan=5>팀을 선택하세요.</td>	
							</tr>
						</tbody>
						<script type="text/x-jsrender" id="<@pageId>_teamMemberList_template">						
							{{for list}}
							<tr>
								<td>{{:#index + 1}}</td>
								<td>{{:USER_ID}}</td>
								<td>{{:USER_NM}}</td>
								<td>{{:TEAM_USER_ROLE_NM}}</td>
								<td>{{:GRADE}}</td>
							</tr>
							{{/for}}
						</script>
						<script type="text/x-jsrender" id="<@pageId>_teamMemberList_noData_template">	
							<tr>	
								<td colspan=5>팀 Member가 없습니다.</td>	
							</tr>
						</script>
						
					</table>
				</div>
			</div>
		</div>

	</section>
</div>
