<meta charset="utf-8">
<script type="text/javascript">
    var <@compId> = {
             searchedRows : [] // 페이지
            ,region : ''
            ,supervisor : ''
            ,store : ''
            ,pageInit : () => {
            	
                const yearsArray = Array.from({ length: 6 }, (_, index) => {
                      const year = 2020 + index;
                      return [year.toString(), year + "년"];
                });
                var yearsArrayList = { data : yearsArray,targetId : "<@compId>_selectBoxYear"}
                C_UICOM.makeSelectBox(yearsArrayList, "single");
                C_UICOM.setSingleBox("<@compId>_selectBoxYear", dayjs().year());
                
                // 월
                var monthList = C_COM.getCodeList("STORE_MONTH");
                
                var selectBoxMonthList = { 
                     data : monthList
                    ,targetId : "<@compId>_selectBoxMonth" 
                }
                C_UICOM.makeSelectBox(selectBoxMonthList, "single");
                
                // 권역
                var regionList = C_COM.getCodeList("STORE_REGION");
                //dalert(regionList);
                var selectBoxRegionList = { 
                     defaultItem    : ["ALL", "전체"] 
                    ,data : regionList
                    ,targetId : "<@compId>_selectBoxRegion" 
                }
                C_UICOM.makeSelectBox(selectBoxRegionList, "single");
                <@compId>.region = "ALL";
                
                C_UICOM.addChangeListner("<@compId>_selectBoxRegion", function(dataObj) {
                    console.log("_selectBoxRegion  =>"+dataObj);
                    <@compId>.region = dataObj;
                    <@compId>.getSelectStore();
                });
                
                // 매장
                <@compId>.getSelectStore();
                
                // 슈퍼바이저
                var supervisorList = C_COM.getCodeList("SUPERVISOR");
                
                var selectBoxSupervisorList = {

                     defaultItem    : ["ALL", "전체"]
                    ,data : supervisorList
                    ,targetId : "<@compId>_selectBoxSupervisor" 
                }
                C_UICOM.makeSelectBox(selectBoxSupervisorList, "single");
                <@compId>.supervisor = "ALL";
                
                C_UICOM.addChangeListner("<@compId>_selectBoxSupervisor", function(dataObj) {
                    console.log("_selectBoxSupervisor  =>"+dataObj);
                    <@compId>.supervisor = dataObj;
                });
                
            }

            ,getSelectStore : () => {
            	
            	console.log("getSelectStore =>"+<@compId>.region );
            	
            	let requestParm = {};
                requestParm["spCstmId"] = G_VAL.session.spCstmId ;
                requestParm["region"] = <@compId>.region ;
                
                console.log("=== region ===>"+<@compId>.region);
                
                var parm1 = {
                        queryId  : "dashboardCorPerformance.getStore"
                       ,requestParm   : requestParm
                }
                
                C_COM.requestQuery(parm1, function(resultData) {
                    
                    const DATA = resultData.data.map( item => [ item.CODE_ID, item.CODE_NM ]);
                    
                    var selectBoxStoreList = {
                            defaultItem    : ["ALL", "전체"]
                           ,data : DATA
                           ,targetId : "<@compId>_selectBoxStore" 
                    }
                    
                    C_UICOM.makeSelectBox(selectBoxStoreList, "single");
                });
                
                C_UICOM.addChangeListner("<@compId>_selectBoxStore", function(dataObj) {
                    <@compId>.store = dataObj;
                });
            }
            ,setChart : () => {

                let requestParm221 = {};
                requestParm221["spCstmId"]  = "starasset";
                requestParm221["year"]      = "2023";
                var parm221 = {
                        queryId  : "dashboardCorPerformance.SalesAndGoalSales"
                       ,requestParm   : requestParm221
                }
                
                C_COM.requestQuery(parm221, function(resultData) {
                    <@compId>.setChart221( resultData );

                });
                
                let requestParm231 = {};
                requestParm231["spCstmId"]  = "starasset";
                requestParm231["year"]      = "2023";
                requestParm231["month"]     = "03";
                requestParm231["preYear"]   = "2023";
                requestParm231["preMonth"]  = "02";
                
                var parm231 = {
                        queryId  : "dashboardCorPerformance.getComparisonPreMonth"
                       ,requestParm   : requestParm231
                }
                
                C_COM.requestQuery(parm231, function(resultData) {
                    <@compId>.setChart231( resultData );

                });
            }

            ,setChart221 : (resultData) =>{

                let categoriesList = [];
                let salesList      = [];
                let goalSalesList  = [];
                
                for (var i=0; i< resultData.data.length; i++){
                    categoriesList[i] = resultData.data[i].STORE_NM3;
                    salesList[i]      = resultData.data[i].AMOUNT;
                    goalSalesList[i]  = resultData.data[i].AMOUNT_GOAL;
                }
                
                $("#<@compId>_chart221").highcharts({
                   
                     chart: {
                            type: 'column'
                        },
                        title: {
                            text: '2023-01-01 ~ 2023-08-31',
                            align: 'left'
                        },
                        subtitle: {
                            text: '',
                            align: 'left'
                        },
                        colors: ['#66ff00', '#0099ff'],
                        xAxis: {
                            categories: categoriesList,
                            crosshair: true,
                            accessibility: {
                                description: 'Countries'
                            }
                        },
                        yAxis: {
                            min: 0,
                            title: {
                                text: ''
                            }
                        },
                        tooltip: {
                            valueSuffix: ''
                        },
                        plotOptions: {
                            column: {
                                pointPadding: 0.2,
                                borderWidth: 0
                            }
                        },
                        series: [
                            {
                                name: '순매출액',
                                data: salesList
                            },
                            {
                                name: '목표금액',
                                data: goalSalesList
                            }
                        ]
                });
            }//setChart221
            
            ,setChart231 : (resultData) =>{

                let categoriesList = [];
                let salesList      = [];
                let goalSalesList  = [];
                
                for (var i=0; i< resultData.data.length; i++){
                    categoriesList[i] = resultData.data[i].STORE_NM3;
                    salesList[i]      = resultData.data[i].AMOUNT;
                    goalSalesList[i]  = resultData.data[i].AMOUNT_PREVIOUS;
                    /*
                    console.log("STORE_NM3 =>"+categoriesList[i]);
                    console.log("AMOUNT =>"+salesList[i]);
                    console.log("AMOUNT_PREVIOUS =>"+goalSalesList[i]);
                    */
                }
                /* */
                $("#<@compId>_chart231").highcharts({
                   
                     chart: {
                            type: 'column'
                        },
                        title: {
                            text: '2023-03',
                            align: 'left'
                        },
                        subtitle: {
                            text: '',
                            align: 'left'
                        },
                        colors: ['#66ff00', '#0099ff'],
                        xAxis: {
                            categories: categoriesList,
                            crosshair: true,
                            accessibility: {
                                description: 'Countries'
                            }
                        },
                        yAxis: {
                            min: 0,
                            title: {
                                text: ''
                            }
                        },
                        tooltip: {
                            valueSuffix: ''
                        },
                        plotOptions: {
                            column: {
                                pointPadding: 0.2,
                                borderWidth: 0
                            }
                        },
                        series: [
                            {
                                name: '순매출액',
                                data: salesList
                            },
                            {
                                name: '전월금액',
                                data: goalSalesList
                            }
                        ]
                });
               
            }//setChart211
            
            /* 목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    */
            ,searchGoals : ( startDate, endDate ) => {
            	console.log("=== searchGoals  1  ===");
            	let goals1 = '11%';
            	let goals2 = '22%';
            	let goals3 = '33%';
                
            	$('#<@compId>_goals1').text(goals1);
            	$('#<@compId>_goals2').text(goals2);
            	$('#<@compId>_goals3').text(goals3);
            }

            
            /* 목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    */
            ,searchChart11 : ( startDate, endDate ) => {
            	 console.log("=== searchList1  1  ===");

                 let requestParm = {};            
                 requestParm["startDate"]   = startDate+"-01";
                 requestParm["endDate"]     = endDate+"-01";           
                 requestParm["region"]      = <@compId>.region ;
                 requestParm["supervisor"]  = <@compId>.supervisor ;
                 requestParm["spCstmId"]    = G_VAL.session.spCstmId ;

                 let parm = {
                      queryId        : "dashboardCorPerformance.getRegionCnt"
                     ,requestParm    : requestParm
                 }
                 C_COM.requestQuery(parm, function(resultData) {
                     
                     <@compId>.setChart11( resultData );
                 });
                
            }


            ,setChart11 : (resultData) =>{
                
                console.log("=== setChart1");

                //console.log("=== setChart21Data");
                let ymdArry = [];
                let openArry = [];
                let closeArry = [];
                let allArry = [];
                /*
                var j = 0;
                for (var i=0; i< resultData.data.list.length; i++){                        
                    ymdArry[i] = resultData.data.list[i].YYYYMM.replace('-', '.');
                    openArry[i] = parseInt(resultData.data.list[i].OPEN);
                    closeArry[i] = parseInt(resultData.data.list[i].CLOSE);
                    allArry[i] = parseInt(resultData.data.list[i].ALL);
                }
                */
                
                $('#<@compId>_chart11').highcharts({

                    chart: {
                    	type: 'bar'
                    },


                    title: {
                        text: '목표대비 달성률'
                    },


                    xAxis: {
                    	categories: ['수원영통점', '전주우이점', '부천송내점', '광안점', '정관점'],
                    },

                    yAxis: {
                        title: {
                            text: ''
                        }
                    },

                    tooltip: {
                        valueSuffix: '%'
                    },

                    plotOptions: {
                        bar: {
                            borderRadius: '50%',
                            dataLabels: {
                                enabled: true,
                                format: '{y}%'
                            },
                            groupPadding: 0.1
                        }
                    },

                    legend: {
                        enabled: false
                    },

                    series: [{
                        name: '',
                        data: [37.78, 36.98, 36.33, 36.14, 34.77]
                    }]

                });
            }//setChart1
            /* 목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    목표대비 달성률    */
            
            /* 목표대비 테이블 회전률    목표대비 테이블 회전률    목표대비 테이블 회전률    목표대비 테이블 회전률    목표대비 테이블 회전률    */
            ,searchChart12 : ( startDate, endDate ) => {
            
                 console.log("=== searchChart12  1  ===");

                 let requestParm = {};            
                 requestParm["startDate"]   = startDate+"-01";
                 requestParm["endDate"]     = endDate+"-01";           
                 requestParm["region"]      = <@compId>.region ;
                 requestParm["supervisor"]  = <@compId>.supervisor ;
                 requestParm["spCstmId"]    = G_VAL.session.spCstmId ;

                 let parm = {
                      queryId        : "dashboardCorPerformance.getRegionCnt"
                     ,requestParm    : requestParm
                 }
                 C_COM.requestQuery(parm, function(resultData) {
                     
                     <@compId>.setChart12( resultData );
                 });
                
            }


            ,setChart12 : (resultData) =>{
                
                console.log("=== setChart12");

                //console.log("=== setChart21Data");
                let ymdArry = [];
                let openArry = [];
                let closeArry = [];
                let allArry = [];
                /*
                var j = 0;
                for (var i=0; i< resultData.data.list.length; i++){                        
                    ymdArry[i] = resultData.data.list[i].YYYYMM.replace('-', '.');
                    openArry[i] = parseInt(resultData.data.list[i].OPEN);
                    closeArry[i] = parseInt(resultData.data.list[i].CLOSE);
                    allArry[i] = parseInt(resultData.data.list[i].ALL);
                }
                */
                
                $('#<@compId>_chart12').highcharts({

                    chart: {
                        type: 'bar'
                    },


                    title: {
                        text: '목표대비 테이블 회전률'
                    },


                    xAxis: {
                        categories: ['수원영통점', '전주우이점', '부천송내점', '광안점', '정관점'],
                    },

                    yAxis: {
                        title: {
                            text: ''
                        }
                    },

                    tooltip: {
                        valueSuffix: '%'
                    },

                    plotOptions: {
                        bar: {
                            borderRadius: '50%',
                            dataLabels: {
                                enabled: true,
                                format: '{y}%'
                            },
                            groupPadding: 0.1
                        }
                    },

                    legend: {
                        enabled: false
                    },

                    series: [{
                        name: '',
                        data: [37.78, 36.98, 36.33, 36.14, 34.77]
                    }]

                });
            }
            /* 목표대비 테이블 회전률    목표대비 테이블 회전률    목표대비 테이블 회전률    목표대비 테이블 회전률    목표대비 테이블 회전률    */
            
            /* 전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    */
            ,searchChart21 : ( startDate, endDate ) => {
            
                 console.log("=== searchChart21  1  ===");

                 let requestParm = {};            
                 requestParm["startDate"]   = startDate+"-01";
                 requestParm["endDate"]     = endDate+"-01";           
                 requestParm["region"]      = <@compId>.region ;
                 requestParm["supervisor"]  = <@compId>.supervisor ;
                 requestParm["spCstmId"]    = G_VAL.session.spCstmId ;

                 let parm = {
                      queryId        : "dashboardCorPerformance.getRegionCnt"
                     ,requestParm    : requestParm
                 }
                 C_COM.requestQuery(parm, function(resultData) {
                     
                     <@compId>.setChart21( resultData );
                 });
                
            }


            ,setChart21 : (resultData) =>{
                
                console.log("=== setChart21");

                //console.log("=== setChart21Data");
                let ymdArry = [];
                let openArry = [];
                let closeArry = [];
                let allArry = [];
                /*
                var j = 0;
                for (var i=0; i< resultData.data.list.length; i++){                        
                    ymdArry[i] = resultData.data.list[i].YYYYMM.replace('-', '.');
                    openArry[i] = parseInt(resultData.data.list[i].OPEN);
                    closeArry[i] = parseInt(resultData.data.list[i].CLOSE);
                    allArry[i] = parseInt(resultData.data.list[i].ALL);
                }
                */
                
                $('#<@compId>_chart21').highcharts({

                    chart: {
                        type: 'bar'
                    },


                    title: {
                        text: '전월대비 달성률'
                    },


                    xAxis: {
                        categories: ['수원영통점', '전주우이점', '부천송내점', '광안점', '정관점'],
                    },

                    yAxis: {
                        title: {
                            text: ''
                        }
                    },

                    tooltip: {
                        valueSuffix: '%'
                    },

                    plotOptions: {
                        bar: {
                            borderRadius: '50%',
                            dataLabels: {
                                enabled: true,
                                format: '{y}%'
                            },
                            groupPadding: 0.1
                        }
                    },

                    legend: {
                        enabled: false
                    },

                    series: [{
                        name: '',
                        data: [37.78, 36.98, 36.33, 36.14, 34.77]
                    }]

                });
            }
            /* 전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    전월대비 달성률    */
            
            /* 전월대비 테이블회전률    전월대비 테이블회전률    전월대비 테이블회전률    전월대비 테이블회전률    전월대비 테이블회전률    */
            ,searchChart22 : ( startDate, endDate ) => {
                 console.log("=== searchChart22  1  ===");

                 let requestParm = {};            
                 requestParm["startDate"]   = startDate+"-01";
                 requestParm["endDate"]     = endDate+"-01";           
                 requestParm["region"]      = <@compId>.region ;
                 requestParm["supervisor"]  = <@compId>.supervisor ;
                 requestParm["spCstmId"]    = G_VAL.session.spCstmId ;

                 let parm = {
                      queryId        : "dashboardCorPerformance.getRegionCnt"
                     ,requestParm    : requestParm
                 }
                 C_COM.requestQuery(parm, function(resultData) {
                     
                     <@compId>.setChart22( resultData );
                 });
                
            }


            ,setChart22 : (resultData) =>{
                
                console.log("=== setChart22");

                //console.log("=== setChart21Data");
                let ymdArry = [];
                let openArry = [];
                let closeArry = [];
                let allArry = [];
                /*
                var j = 0;
                for (var i=0; i< resultData.data.list.length; i++){                        
                    ymdArry[i] = resultData.data.list[i].YYYYMM.replace('-', '.');
                    openArry[i] = parseInt(resultData.data.list[i].OPEN);
                    closeArry[i] = parseInt(resultData.data.list[i].CLOSE);
                    allArry[i] = parseInt(resultData.data.list[i].ALL);
                }
                */
                
                $('#<@compId>_chart22').highcharts({

                    chart: {
                        type: 'bar'
                    },


                    title: {
                        text: '전월대비 달성률'
                    },


                    xAxis: {
                        categories: ['수원영통점', '전주우이점', '부천송내점', '광안점', '정관점'],
                    },

                    yAxis: {
                        title: {
                            text: ''
                        }
                    },

                    tooltip: {
                        valueSuffix: '%'
                    },

                    plotOptions: {
                        bar: {
                            borderRadius: '50%',
                            dataLabels: {
                                enabled: true,
                                format: '{y}%'
                            },
                            groupPadding: 0.1
                        }
                    },

                    legend: {
                        enabled: false
                    },

                    series: [{
                        name: '',
                        data: [37.78, 36.98, 36.33, 36.14, 34.77]
                    }]

                });
            }
            /* 전월대비 테이블회전률    전월대비 테이블회전률    전월대비 테이블회전률    전월대비 테이블회전률    전월대비 테이블회전률    */
            
            ,setHandler : () => {
                
                $("#<@compId>_searchBtn1").click( () =>{
                    console.log(" _searchBtn 클릭");

                   
                    let startDate = "2024-04-16";
                    let endDate   = "2024-04-19";

                    <@compId>.searchGoals( startDate, endDate );
                    
                    <@compId>.searchChart11( startDate, endDate );
                    <@compId>.searchChart12( startDate, endDate );
                    <@compId>.searchChart21( startDate, endDate );
                    <@compId>.searchChart22( startDate, endDate );
                })
            }
    }
    // Component Load가 완료된후 실행 된다.
    C_COMP.onLoadComp("<@compId>", function(data) {
        <@compId>.pageInit();
        <@compId>.setHandler();
        <@compId>.setChart();
    });
</script>

<div>
    <!--// 일별 매출 달성률 -->
    <!-- search area -->
    <div class="search_area plpr5">
        <div class="fl">
            
            <div class="select_box fl" style="width:132px">
                <div id="<@compId>_selectBoxYear" style="width:132px"></div>
            </div>
            <div class="select_box fl" style="width:132px">
                <div id="<@compId>_selectBoxMonth" style="width:132px"></div>
            </div>
            <span class="tit01 fl lh33">권역</span>
            <!-- 권역 선택 -->
            <div class="select_box fl" style="width:100px">
                <div id="<@compId>_selectBoxRegion" style="width:100px"></div>
            </div>
            <!-- 매장명 선택 -->
            <div class="select_box fl" style="width:170px">
                <div id="<@compId>_selectBoxStore" style="width:170px"></div>
            </div>   
            <span class="tit01 fl lh33">슈퍼바이저</span>
            <!-- 슈퍼바이저 선택 -->
            <div class="select_box fl" style="width:132px">
                 <div id="<@compId>_selectBoxSupervisor" style="width:132px"></div>
            </div>
            <button type="button" class="btn select fl" id="<@compId>_searchBtn1">조회</button>
            
            
        </div>
    </div>
    <section class="sec_wrap">
        <div class="cont_box">
            <div class="clearFix">
                <h3 class="fl">목표대비 달성률</h3>
                <a href="#modal-ex" class="btn fr">확대하기</a>
            </div>
            <div class="goals_chart_wrap">
                <div class="goalsChart_item">
                    <h3>달성률</h3>
                    <div class="percent_wrap" id="<@compId>_goals1">33.73%</div>
                </div>
                <div class="goalsChart_item">
                    <div class="percent_small_wrap">
                        <h3>테이블 회전률</h3>
                        <div class="percent_wrap" id="<@compId>_goals2"><span class="num">28.10</span>%</div>
                    </div>
                    <div class="percent_small_wrap">
                        <h3>전년 대비 성장률</h3>
                        <div class="percent_wrap" id="<@compId>_goals3"><span class="num">79.36</span>%</div>
                    </div>
                </div>
                <div class="goalsChart_item">
                    <figure class="highcharts-figure2">
                        <div class="chart03_01" id="<@compId>_chart11" style="width:100%;height:280px;margin:0 auto">
                        </div>
                    </figure>
                </div>
                <div class="goalsChart_item">
                    <figure class="highcharts-figure2">
                        <div class="chart03_02" id="<@compId>_chart12" style="width:100%;height:280px;margin:0 auto">
                        </div>
                    </figure>
                </div>
            </div>
        </div>
    </section>

    <section class="sec_wrap">
        <div class="cont_box">
            <div class="clearFix">
                <h3 class="fl">테이블 회전률</h3>
                <a href="#modal-ex2" class="btn fr">확대하기</a>
            </div>
            <div class="goals_chart_wrap">
                <div class="goalsChart_item">
                    <h3>달성률</h3>
                    <div class="percent_wrap"><span class="num">33.73</span>%</div>
                </div>
                <div class="goalsChart_item v2">
                    <h3>테이블 회전률</h3>
                    <div class="percent_wrap"><span class="num">67.33</span>%</div>
                </div>
                <div class="goalsChart_item">
                    <figure class="highcharts-figure2">
                        <div class="chart03_01" id="<@compId>_chart21" style="width:100%;height:280px;margin:0 auto">
                        </div>
                    </figure>
                </div>
                <div class="goalsChart_item">
                    <figure class="highcharts-figure2">
                        <div class="chart03_02" id="<@compId>_chart22" style="width:100%;height:280px;margin:0 auto">
                        </div>
                    </figure>
                </div>
            </div>
        </div>
    </section>
    <!-- search area -->
    <div class="search_area plpr5 mt35">
        <div class="fl">
            <div class="calendar_wrap fl">
                <input type="text" id="from3" name="from3" class="datepicker" style="width:114px">
                <label for="to">~</label>
                <input type="text" id="to3" name="to3" class="datepicker" style="width:114px">
            </div>
            <button class="btn select fl">검색</button>
        </div>
    </div>
    <section class="sec_wrap">
        <div class="cont_box">
            <h3>매출 분석</h3>
            <figure class="highcharts-figure2">
                <div class="chart04_01" id="<@compId>_chart221" style="width:100%;height:332px;margin:0 auto">
                </div>
            </figure>
        </div>
    </section>
    <section class="sec_wrap">
        <div class="cont_box">
            <h3>매출 분석</h3>
            <figure class="highcharts-figure2">
                <div class="chart04_01" id="<@compId>_chart231" style="width:100%;height:332px;margin:0 auto">
                </div>
            </figure>
        </div>
    </section>
    <!-- 일별 매출 달성률 //-->
</div>


