<meta charset="utf-8">
<script type="text/javascript">
    var <@popupId> = {
    	 regMember : {}
    	,appMember : []	
        ,memberSearchPopup : function() {
            C_POP.open('popup_userSearchPopup', {}, function(retData) {
                <@popupId>.addMember(retData);
            });
         }
        ,callCompFn : function() {
            <@popupId>.textEditorComp.testFn("aaa");
         }
        ,callCompSetMode : function() {
        	let parm = {mode:"R"}
            <@popupId>.textEditorComp.setMode(parm);
         }
        ,addMember : function(retData) {
        	
         }

        ,setSelectUser : function(buttonId) {
            
         }
        /* 결재상신 */
        ,save : function (state) {
            
         }
        ,deleteUser : function(num) {/* 결재자 삭제 */

         }
        ,close : function() {
            C_POP.close();
         }
        
    }
    // Popup Load가 완료된후 실행 된다.
    C_POP.onLoadPopup("<@popupId>", function(data) {

    	<@popupId>.apprId = C_COM.makeUniqueId();// 결재 ID 생성
    	
    	// 결재 Textarea Component Include
    	C_COMP.import("textEditorComp", "component_compTextEditor", {content:""}, function(data) {
            console.log(data.editorData);
            <@popupId>.editorData = data.editorData;
        });
        
		// 첨부파일 컴포넌트 추가
    	var parm = {
			 GRP_FILE_ID 	: <@popupId>.apprId
			,OWNER_CD 		: "APPROVAL"
			,mode			: "M"
			,title			: "NA"
			,allowExt		: ["jpg", "jpeg", "png", "gif", "bmp"]
		}
		C_COMP.import("appFileMng", "component_compMultiFilemng", parm , function() {
			
		});
		
		
		// 기안자 추기
    	<@popupId>.regMember = fn_copyObject(G_VAL.session);

    	html = $("#<@popupId> "	).render(parm);    	
    	
        let parm = {
             targetId   : "tableId"
            ,templateId : "reqMember"
            ,regMember  : <@popupId>.regMember
        }
        C_COM.renderHtml("<@pageId>", parm);
    });
    
    
</script>



	<div class="modal_wrap" id="modal-ex01">
		<div class="modal" style="width:800px;height:800px;">
			<div class="modal_header">
				<strong class="tit">결재 상신</strong>
				<button type="button" class="btn_close" onclick="<@popupId>.close()"><span class="sp">팝업 닫기</span></button>
			</div>
			<div class="modal_body">
				<dl class="info_wrap pay">
                    <dt>제목</dt>
                    <dd><input type="text"  id='title' name='title' value='' style="width:100%"></dd>
					<dt>결재자 검색</dt>
					<dd>
                        <div class="search_inputWrap" style="width:100%">
                            <input type="search" name="">
                            <button class="search_btn">
                                <a href="javascript:void(0);" onclick="<@popupId>.memberSearchPopup();"><i class="icon_search"></i></a>
                            </button>
                        </div>
					</dd>
					<dt>결재자 리스트</dt>
					<dd class="mb0" style="height:120px;overflow-y:auto;">
						<div class="approver_list_wrap">
							<ul class="approver_list" id="signMember">
							</ul>
							<script type="text/x-jsrender" id="signMember_template">	
								<li>
									<button class="stateBtn toggle active">결재</button>
									<button class="stateBtn toggle">합의</button>
									<button class="stateBtn toggle">통보</button>
									<span class="txt">{{:userNm}} / {{:grade}} / {{:email}}</span>
									<button class="pay_close">닫기</button>
								</li>
							</script>
							<script type="text/x-jsrender" id="reqMember_template">	
								<li>
									<span class="stateBtn drafter">기 안 자</span>
									<span class="txt">{{:regMember.userNm}} / {{:regMember.grade}} / {{:regMember.email}}</span>
								</li>
							</script>
						</div>
					</dd>
					<dt>상신 내용</dt>
					<dd><div id="textEditorComp"></div></dd>
					<dt>첨부파일</dt>
					<dd id="appFileMng">
					</dd>
				</dl>
			</div>
			<div class="modal_footer">
				<button type="button" class="btn select">결재 상신</button>
				<button type="button" class="btn select">보류함</button>
				<button type="button" class="btn close">취소</button>
			</div>
		</div>
	</div>



