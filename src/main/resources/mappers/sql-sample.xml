<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Sample">

	<cache />
	
	<!-- MVT 및 Model의 실제 Data (관련 Table => T_MDL_MODEL_SAVE, T_MDL_MODEL_SAVE_MVT_ITEM) -->
	<select id="getSample" resultType="java.util.HashMap" flushCache="true"  useCache="false">
		SELECT T_CLM 
		FROM TEST 
		WHERE 1 = 1
	</select>

    <insert id="setFile" parameterType="map" useGeneratedKeys="true" keyProperty="userId">
        /* Sample.setFile */
       INSERT INTO TBL_EXP_FILEMNG(
             UUID
            ,GRP_ID
            ,ORG_FILE_NAME
            ,STORED_FILE_NAME
            ,FILE_PATH

            ,FILE_SIZE
            ,FILE_TYPE
            ,CREATE_USER
            ,CREATE_DATE
        )
        VALUES(
            #{uuid},
            #{grpId},
            #{orgFileName},
            #{storedFileName},
            #{filePath},
            
            TO_NUMBER(#{fileSize}),
            #{fileType},
            #{createUser},
            (TO_DATE(#{createDate} , 'yyyy/mm/dd hh24:mi:ss') )
        )
    </insert>
    <!-- 첨부파일 조회 이응규 -->
	<select id="getFile" resultType="java.util.HashMap">
	    /* Sample.getFile */
        SELECT UUID             AS uuid           
              ,GRP_ID           AS grpId          
              ,ORG_FILE_NAME    AS orgFileName    
              ,STORED_FILE_NAME AS storedFileName 
              ,FILE_PATH        AS filePath       
              ,FILE_SIZE        AS fileSize       
              ,FILE_TYPE        AS fileType       
              ,UPDATE_USER      AS updateUser     
              ,UPDATE_DATE      AS updateDate     
              ,CREATE_USER      AS createUser     
              ,CREATE_DATE      AS createDate
        FROM   TBL_EXP_FILEMNG
        WHERE    1 = 1
        <if test=" grpId != null and grpId != '' " >
          AND    GRP_ID = #{grpId}
        </if><if test=" uuid != null and uuid != '' " >
          AND    UUID = #{uuid}
        </if>
        ORDER BY CREATE_DATE DESC
	</select>
	
	<!-- 첨부파일 삭제  이응규 -->
    <delete id="deleteFile" parameterType="java.util.HashMap"  >
        /* Sample.deleteFile */
        DELETE FROM TBL_EXP_FILEMNG
        WHERE  1 = 1
        <if test=" grpId != null and grpId != '' " >
          AND    GRP_ID = #{grpId}
        </if>
        <if test=" uuid != null and uuid != '' " >
          AND    UUID = #{uuid}
        </if>
    </delete>
    
    <!-- 게시판 조회 이응규 -->
    <select id="getBoardList" resultType="java.util.HashMap">
        /* Sample.getBoardList */
        SELECT UUID
              ,BOARD_CODE
              ,TITLE
              ,CONTENTS
              ,DELETE_YN
              ,UPDATE_USER
              ,UPDATE_DATE
              ,CREATE_USER
              ,CREATE_DATE
        FROM   TBL_EXP_BOARD
        WHERE  1 = 1
        <if test=" boardCode != null and boardCode != '' " >
          AND    BOARD_CODE = #{boardCode}
        </if><if test=" uuid != null and uuid != '' " >
          AND    UUID = #{uuid}
        </if>
        ORDER BY CREATE_DATE DESC
    </select>
    
    
    <!--  결재 조회 이응규 -->
    <select id="getApproval" resultType="java.util.HashMap" flushCache="true"  useCache="false">
        /* Sample.getApproval */
        SELECT UUID
		      ,REQUEST_USER
		      ,TITLE
		      ,CONTENTS
		      ,STATE
		      ,APPROVAL_DATE
		      ,TO_CHAR( APPROVAL_DATE , 'YYYY-MM-DD HH24:MI:SS' ) APPROVAL_DATE1
		      ,UPDATE_USER
		      ,UPDATE_DATE
		      ,CREATE_USER
		      ,CREATE_DATE
		      ,TO_CHAR( CREATE_DATE , 'YYYY-MM-DD HH24:MI:SS' ) CREATE_DATE1 
		FROM  TBL_EXP_APPROVAL
		WHERE 1 = 1
        <if test=" requestUser != null and requestUser != '' " >
          AND   REQUEST_USER = #{requestUser}
        </if><if test=" uuid != null and uuid != '' " >
          AND    UUID = #{uuid}
        </if>
        ORDER BY APPROVAL_DATE DESC
    </select>

    
</mapper>
